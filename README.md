# SSH Gate API

REST API для управления пользователями и их доступом к серверам через SSH.

## Требования

- Go 1.24 или выше
- Доступ к серверам по SSH с использованием приватного ключа
- Приватный ключ для подключения к серверам

## Настройка

1. Установите зависимости:
```bash
go mod download
```

2. Укажите путь к приватному ключу через переменную окружения:
```bash
export SSH_PRIVATE_KEY_PATH="/path/to/your/private/key"
```

## API Endpoints

### Пользователи

#### Создание пользователя
```
POST /api/users
Content-Type: application/json

{
    "username": "user1",
    "public_key": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC6eNtGpNGwstc...."
}
```

#### Получение пользователя по ID
```
GET /api/users/{id}
```

#### Получение всех пользователей
```
GET /api/users
```

### Серверы

#### Создание сервера
```
POST /api/servers
Content-Type: application/json

{
    "ip": "192.168.1.100"
}
```

#### Получение сервера по ID
```
GET /api/servers/{id}
```

#### Получение всех серверов
```
GET /api/servers
```

### Управление доступом пользователей к серверам

#### Привязка сервера к пользователю
```
POST /api/users/{userId}/servers/{serverId}
```

При этом публичный ключ пользователя будет автоматически добавлен в файл `authorized_keys` на сервере.

#### Получение всех серверов пользователя
```
GET /api/users/{userId}/servers
```

#### Удаление привязки сервера к пользователю
```
DELETE /api/users/{userId}/servers/{serverId}
```

При этом публичный ключ пользователя будет автоматически удален из файла `authorized_keys` на сервере.

## Запуск сервера

```bash
go run main.go
```

Сервер будет доступен по адресу `http://localhost:8080`.

## Безопасность

- Убедитесь, что файл с приватным ключом имеет правильные права доступа (600)
- Храните приватный ключ в безопасном месте
- Не передавайте приватный ключ третьим лицам
- Регулярно обновляйте приватный ключ 